<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    canvas {
      border: 1px solid #000;
      display: block;
      margin: 20px auto;
    }
  </style>
  <title>Flappy Bird</title>
</head>
<body>
  <canvas id="gameCanvas" width="480" height="320"></canvas>

  <script>
    // Get the canvas and context
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    // Bird properties
    const bird = {
      x: 50,
      y: canvas.height / 2 - 15,
      radius: 15,
      velocity: 0,
      gravity: 0.5,
      jump: -8
    };

    // Pipe properties
    const pipes = [];
    const pipeWidth = 50;
    const pipeHeight = 200;
    const pipeGap = 100;
    const pipeSpeed = 2;

    // Handle spacebar press
    document.addEventListener("keydown", function(event) {
      if (event.code === "Space") {
        bird.velocity = bird.jump;
      }
    });

    function drawBird() {
      ctx.beginPath();
      ctx.arc(bird.x, bird.y, bird.radius, 0, Math.PI * 2);
      ctx.fillStyle = "yellow";
      ctx.fill();
      ctx.closePath();
    }

    function drawPipe(pipeX, pipeHeight, isBottom) {
      ctx.fillStyle = "green";
      ctx.fillRect(pipeX, isBottom ? canvas.height - pipeHeight : 0, pipeWidth, pipeHeight);
    }

    function draw() {
      // Clear the canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Update bird position and velocity
      bird.velocity += bird.gravity;
      bird.y += bird.velocity;

      // Draw bird
      drawBird();

      // Generate pipes
      if (Math.random() < 0.02) {
        pipes.push({ x: canvas.width, height: Math.random() * (canvas.height - pipeGap * 2) + pipeGap });
      }

      // Move and draw pipes
      for (let i = pipes.length - 1; i >= 0; i--) {
        pipes[i].x -= pipeSpeed;
        drawPipe(pipes[i].x, pipes[i].height, false);
        drawPipe(pipes[i].x, canvas.height - pipes[i].height - pipeGap, true);

        // Check for collisions
        if (
          bird.x + bird.radius > pipes[i].x &&
          bird.x - bird.radius < pipes[i].x + pipeWidth &&
          (bird.y - bird.radius < pipes[i].height || bird.y + bird.radius > canvas.height - pipes[i].height - pipeGap)
        ) {
          alert("Game over!");
          pipes.length = 0; // Clear pipes array
          bird.y = canvas.height / 2 - 15; // Reset bird position
          bird.velocity = 0; // Reset bird velocity
        }

        // Remove off-screen pipes
        if (pipes[i].x + pipeWidth < 0) {
          pipes.splice(i, 1);
        }
      }

      // Check for bird out-of-bounds
      if (bird.y - bird.radius < 0 || bird.y + bird.radius > canvas.height) {
        alert("Game over!");
        pipes.length = 0; // Clear pipes array
        bird.y = canvas.height / 2 - 15; // Reset bird position
        bird.velocity = 0; // Reset bird velocity
      }

      // Repeat the draw function
      requestAnimationFrame(draw);
    }

    // Start the game loop
    draw();
  </script>
</body>
</html>
